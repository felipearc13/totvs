```
SELECT
	NOMECLIENTE AS NOME,
	SZORCAMENCLI.DESCPROCEDIMENTO AS PROCEDIMENTO,
	TOTAL AS VALOR,
	SZCADGERAL.RAZAOSOCIAL AS MEDICO,
	SZORCAMENCLI.CODSUBPLANO AS DINHEIRO,
	SZORCAMENCLI.CODSUBPLANO AS DEBITO,
	SZORCAMENCLI.CODSUBPLANO AS CREDITO,
	SZORCAMENCLI.CODSUBPLANO AS BANDEIRA,
	SZORCAMENCLI.CODSUBPLANO AS PARCELA
	
FROM
	SZORCAMENCLI (NOLOCK)
INNER JOIN
	SZORCAMENCLIITEM (NOLOCK) ON SZORCAMENCLI.NUMERO = SZORCAMENCLIITEM.NUMERO
INNER JOIN
	SZCADGERAL (NOLOCK) ON SZORCAMENCLI.CODMEDICO = SZCADGERAL.CODGERAL
	
WHERE 
	DATAORC = :DATA
AND
	SZCADGERAL.CODGERAL = :MEDICO
	
UNION
	
SELECT 
	FCFO.NOME AS NOME,
	STUFF(
		(
			SELECT '+' + CONVERT (VARCHAR (100),DISCRIMINACAOHM)
			FROM SZATENDHONORARIO (NOLOCK)
			WHERE SZATENDIMENTO.NUMEROCONTA = SZATENDHONORARIO.NUMEROCONTA
				AND SZATENDIMENTO.SEQUENCIALCONTA = SZATENDHONORARIO.SEQUENCIALCONTA
			ORDER BY SZATENDHONORARIO.DISCRIMINACAOHM
			FOR XML PATH('')
			), 1, 1, ''
		) AS PROCEDIMENTO,
	TMOV.VALORBRUTOORIG AS VALOR,
	SZCADGERAL.RAZAOSOCIAL AS MEDICO,
	SZATENDEXTCOMPL.DINHEIRO AS DINHEIRO,
	SZATENDEXTCOMPL.DEBITO AS DEBITO,
	SZATENDEXTCOMPL.CREDITO AS CREDITO,
	SZATENDEXTCOMPL.BANDEIRA AS BANDEIRA,
	SZATENDEXTCOMPL.PARCELA AS PARCELA
	 
FROM SZATENDIMENTO (NOLOCK)
INNER JOIN
	SZATENDEXTCOMPL	(NOLOCK) ON SZATENDIMENTO.CODCOLIGADA = SZATENDEXTCOMPL.CODCOLIGADA AND SZATENDIMENTO.CODPACIENTE = SZATENDEXTCOMPL.CODPACIENTE AND SZATENDIMENTO.CODATENDIMENTO = SZATENDEXTCOMPL.CODATENDIMENTO
INNER JOIN
	SZATENDHONORARIO (NOLOCK) ON SZATENDIMENTO.NUMEROCONTA = SZATENDHONORARIO.NUMEROCONTA AND SZATENDIMENTO.SEQUENCIALCONTA = SZATENDHONORARIO.SEQUENCIALCONTA
INNER JOIN
	SZCADGERAL	(NOLOCK) ON SZCADGERAL.CODGERAL = 	SZATENDHONORARIO.CODPRESTADOR
INNER JOIN
	SZPACIENTE (NOLOCK) ON SZATENDIMENTO.CODCOLIGADA = SZPACIENTE.CODCOLIGADA AND SZATENDIMENTO.CODPACIENTE = SZPACIENTE.CODPACIENTE
INNER JOIN
	SZPEDIDOATEND (NOLOCK) ON SZPACIENTE.CODCOLIGADA = SZPEDIDOATEND.CODCOLIGADA    AND    SZPACIENTE.CODPACIENTE = SZPEDIDOATEND.CODPACIENTE
INNER JOIN
	TMOV (NOLOCK) ON SZPEDIDOATEND.IDMOV = TMOV.IDMOV
INNER JOIN
	FCFO (NOLOCK) ON TMOV.CODCOLCFO = FCFO.CODCOLIGADA AND TMOV.CODCFO = FCFO.CODCFO
INNER JOIN
	TITMMOV (NOLOCK) ON TMOV.CODCOLIGADA = TITMMOV.CODCOLIGADA AND TMOV.IDMOV = TITMMOV.IDMOV
WHERE
	SZATENDIMENTO.SEQUENCIALCONTA = SZPEDIDOATEND.SEQUENCIALCONTA
AND
	DATAREALIZACAOHM = :DATA
/*
AND 
	SZATENDHONORARIO.VALORHM NOT IN (0)
*/
AND
	SZCADGERAL.CODGERAL = :MEDICO

ORDER BY 
	NOME
```
